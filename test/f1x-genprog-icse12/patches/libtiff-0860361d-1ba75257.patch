--- a/libtiff/tif_dirread.c
+++ b/libtiff/tif_dirread.c
976c976
< 	if (!dir->tdir_count || !w || (tsize_t)dir->tdir_count / w != cc)
---
> 	if ((((! (dir->tdir_count == 0) || ! (w == 0)) || (((tsize_t)dir->tdir_count / w) != cc)) && (cp != cp)))
